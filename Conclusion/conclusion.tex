\chapter[Conclusions and outlook]{Conclusions and outlook}
\label{chap:conclusion}

\section{Conclusions}
Purple phototrophic bacteria, and more broadly, photosynthetic and phototrophic microorganisms have presented as possible biotechnological solutions to waste treatment and the production of highly valued products such as pigments and agricultural feeds. Their widespread adoption has however been limited due several biochemical and physical limitations, including the delivery of radiation, the mass transfer limitations, mixing requirements, and solid/liquid separation limitations. 
\skippingparagraph
A useful approach to minimise the effects physical and biological limitations is to model the process. Through mechanistic modelling, a deeper understanding of the underlying physics of the system, as well as a platform for design and optimisation can be achieved. This thesis has sought to provide a semi-mechanistic modelling framework in order to address the aforementioned limitations associated with photobioreactors. A process model was developed to describe the metabolism of phototrophic bacteria in anaerobic conditions within a process engineering context. This was required as a basis to understand the limitations of light delivery under an array of operating conditions and designs. As the radiative field within a photobioreactor sharply attenuates within the domain, it was required to extend the biochemical model couple the growth and reactions with spatially varying radiative and hydrodynamic fields. In response to the difficulties in harvesting phototrophic biomass, a biofilm model was developed to show how its growth is coupled to a radiative field. Phototrophic growth in biofilms is desirable as energy-intensive membrane systems can be avoided for biomass/liquid separation. The computational framework has been developed using free and open source software (FOSS) which means that it can be freely downloaded, improved and redistributed. This means that outside of the learning curve associated with Linux-based systems, OpenFOAM and Python, the barriers for contributing to and extending this body of work are minimal.

\subsection{Description of a biochemical process model for phototrophic growth}

A model was developed for the growth of a mixed culture purple phototrophic bacteria system. The model development and implementation was focused on domestic wastewater treatment but could have been extended to growth on other substrates. It was found through a series of batch tests that photoheterotrophic growth was predominant, and photoautotrophic and chemoheterotrophic growth were both considerably slower (roughly one order of magnitude when comparing maximum specific uptake rates).  The rate of decay was higher than that for activated sludge processes and hydrolysis was slower, meaning that biodegradable particulates do not degrade at short solid retention times. 
\skippingparagraph
The mechanisms were explored in greater detail with the aid of batch simulations. The first set of simulations highlighted the requirement of additional readily biodegradable SCOD in order to consume all inorganic nitrogen and phosphorus. For medium strength domestic wastewater, 400 gCOD m\textsuperscript{-3} are required for full inorganic nitrogen and phosphorus assimilation. The second batch simulations looked at the daily cycling between phototrophic and chemotrophic growth for \textit{e.g.} an outdoor photobioreactor depending on direct solar irradiation. Two different specific uptake rates for chemoheterotrophy were used (k\textsubscript{M,ch} = 0.07 and 0.7 d\textsuperscript{-1}). In the case of the higher chemoheterotrophic activity, an increased biomass growth during dark cycles led to acetate accumulation for consumption during light cycles. There was also a net production of hydrogen which meant that substrate was available for photoautotrophic growth during light cycles as well. A final batch simulation was done to analyse biomass behaviour under photoautotrophic activity. With sufficient H\textsubscript{2} as substrate, the determined specific photoautotrophic uptake rate k\textsubscript{M,ic} was compared with those found in literature (\num{0.0034} and \num{0.025} molC gCOD\textsuperscript{-1}d\textsuperscript{-1}). This was to show that while photoautotrophic uptake was insignificant when compared to photoheterotrophic uptake, a change of waste stream leading to a switch to a predominant inorganic electron donor could change the system's behaviour. By using the uptake rates obtained in literature, carbon dioxide fixation could account for more than 30\% of inorganic N and P removal.
\skippingparagraph
The model was then tested in continuous conditions to see how seasonal changes could affect the behaviour of a PPB system for domestic wastewater treatment. The response to seasonal changes was generally rapid. In addition to the simulated seasonal changes, there were two distinct changes in operating conditions, where periods I and III included no additional SCOD, and period II included the addition of SCOD to align with inorganic nitrogen and phosphorus concentrations (a control dosing mechanism). During all periods, average SCOD removal didn't change (87\%) with the remaining SCOD almost entirely consisting of non-biodegradable components. With no additional SCOD, ammonium and phosphate removal efficiencies were 47\% and 59\% respectively. With additional SCOD, the phosphorus removal efficiency achieved 93\%. The near complete removal of phosphorus had an impact on nitrogen removal efficiency, which averaged 74\%. This study also depicted biomass fractionation over continuous operation. From period I to period II, the proportion of solids as PPB biomass increased from 44\% to 53\%, due to the additional SCOD leading to a higher sustained growth by photoheterotrophic metabolism. Biodegradable particulates (X\textsubscript{S}) were accumulated within the reactor; a direct consequence of the low hydraulic retention time imposed. 



\subsection{Inclusion of hydrodynamics and radiative transfer}
This study involved the development and comparison of four different mathematical models and explored how different resolutions in the physics of the system gave different results. The model development used the distributed parameter biokinetic framework described in Chapter 2 and extended that base to include radiative transfer and fluid flows in for both single and two-phased systems. 
\skippingparagraph
The models adopted different layers of complexity which had previously been applied in the literature: a lumped parameter system using a uniform incident irradiance, a lumped system using a uniform irradiance measured halfway into the domain of the reactor, a system of ordinary differential equations using a dynamic input irradiance as determined by a hydrodynamic field, and a full Eulerian CFD solution. 
\skippingparagraph
This study confirmed the hypothesis that the dependency of the system on the radiative field would mean that a lumped parameter approach would not be an appropriate modelling simplification for photobioreactors. The spatial varying nature of the radiative field meant that hydrodynamics and the coupling of the radiative field to the biochemical equations played an important role in describing the system. Generally, the lumped parameter approaches over-predicted growth rates. The results from the particle-radiation dynamics approach approached that of the full Eulerian CFD solution. This can serve as an appropriate simplification when computational infrastructure is lacking for a full CFD solution. 

\subsection{Development of a photobiofilm model}
This study aimed to address the practical and economic concerns related to the separation of phototrophic biomass from liquid streams. In this work a continuum biofilm model was developed and its growth was tracked in two and three dimensional domains with varying radiative source configurations. 
\skippingparagraph
This model was developed using the volume of fluid (VOF) method in OpenFOAM, where both biofilm and liquid were treated as a single fluid with differing characteristic parameters. All particulate species were confined to the biofilm phase fraction, and their growths were incorporated as source terms into the balance equation for volume fraction. The volume fraction state variable was coupled to the momentum equations and growth could ensue.

%\textbf{Paragraph 2: Overarching goal of the thesis}
%This work was done in order to present a modelling framework for the growth of purple phototrophic bacteria. The goal of the framework was to describe the behaviours of PPB in domestic or medium strength wastewaters when subject to substrate limitations, including limitations due to insufficient irradiance. From this mathematical framework, it is expected that model validation and calibration will lead to an industrial tool for process understanding, design and optimisation. 


\section{Significance of the research outcomes}
The development of the biokinetic model was done in such a way that it can be used as a module in the IWA family of models, leading to a broader applicability in plant-wide wastewater treatment simulations and control systems. The model can also be adapted to different applications of purple phototrophic bacteria, such as the production of hydrogen, or growth on non-waste substrates for the production of high value products such as astaxanthin and other pigments. Outside of model applicability and parameter values, the structure of the model provides insight into the metabolism of PPB at a high level of abstraction than metabolic pathway models. This allows the reader to develop an intuition into the behaviour of phototrophic biomass under different operating conditions. 
\skippingparagraph
The extension of the biokinetic model into a distributed parameter framework which describes the hydrodynamics, radiation and the biokinetics allows for a greater understanding of how these physical processes interact. As such, this modelling framework can be used as an optimisation tool where photobioreactor designs seek to minimise the process bottlenecks presented by mixing and light delivery limitations. The development of the \texttt{photoBio} radiative transfer libraries could be implemented in domains outside of the direct use case of photobioreactors. They could be used to model algal or cyanobacterial blooms for prevention purposes. They could additionally be used to describe plant growth in both outdoor and indoor illuminated settings. The inactivation of pathogens, or advanced oxidation processes through ultra-violet radiation could also be modelled using these libraries. The use of CFD in ultra-violet photocatalytic and photolysis processes has been used, but the open nature of the software means that more resources can be attributed to simulations without the associated licensing fees. Further afield, the behaviour of photo-voltaic cells could be modelled using the software developed during this body of work. Although a wide array of applications could benefit from this work, there are some fields for which components of this model would not be appropriate. Most notably, the modelling of medical imaging processes is usually done using Monte Carlo photon flux models, which are both more computationally expensive, and more accurate than the finite volume discrete ordinates method.
\skippingparagraph
This general CFD framework for phototrophic and photosynthetic organisms has been implemented using an open source CFD platform. All extensions to the model must also include the same open source license. This increases accessibility of the model and allows for a wider community to propose improvements and bug fixes, potentially leading to a more robust piece of software. 

\skippingparagraph
\textbf{Biofilm conclusions in their broader context}



\section{Outlook and future work}
\subsection{Quantification of the effects of radiation intensity and frequency on PPB growth}
Monod kinetics were assumed for phototrophic growth throughout this study. The half saturation parameter (K\textsubscript{S,E} = 8.76 W m\textsuperscript{-2}) for irradiance was taken from the literature as wild-type \textit{Rb. sphaeroides} based on an average wavelength of 850 nm \cite{Eltsova2016}. Comparisons were made with a LHII deficient strain which concluded similar results for growth on acetate and lactate. This work would benefit from a study into photoinhibition from an excess of photons. Some studies have observed that photoinhibition starts to occur at solar irradiances of around 1000 W m\textsuperscript{-2}, a common irradiance solar irradiance during midday at about the 42\textsuperscript{nd} parallel (Rome, Madrid, Boston, Wellington \etc) \cite{Adessi2014a,Miyake1999}. 
\skippingparagraph
Different radiative intensities could be desired for different biotechnological applications. For example, if the main goal of a PBR is to treat wastewater to discharge limits, then irradiances which foster a high growth rate would be preferred. There would be a maximum concentration of biomass, above which the performance of the reactor would be limited due to self shading. A completely different radiative intensity might be desired if the goal of the PBR is to produce a certain quantity of pigments or other proteins for use as a basis for high value products.
\skippingparagraph
In order to determine these operating limits, a high throughput batch processing method needs to be developed. As concluded in this thesis, the presence of a radiative intensity field means that spatial variations influence the operation of PBRs. It follows that the determination of biokinetic parameters should be revised by carrying out batch tests on small volumes where the radiative field is as uniform as possible. This has been implemented for high throughput algae batch processing \cite{VanWagenen2014}, however as this system is predominantly anaerobic, logistical questions remain as to how to eliminate oxygen throughout growth and measurement cycles.
\skippingparagraph
Similarly to radiative intensity, different wavelengths can lead to different product outcomes, and an assessment is required to understand how wavelengths can influence phototrophic growth in a mixed culture system. Studies have been carried out to assess the growth and pigment production of PPB in pure cultures, however these results can not be reproduced on mixed culture systems \cite{Kuo2012}. This is due to the influent containing organisms other than PPB, which can dominate the population when solely white light is used \cite{Hulsen2015}. The previous studies don't assess the implications of combining infrared and selected visible wavelength bands. These considerations could be important for different applications using mixed culture PPB. 


\subsection{Consideration of mass transfer between gas and other phases}
The difference between PPB and algae for waste treatment is that photoheterotrophic growth drives the former, while photosynthesis drives the latter. This means that the consideration of gas phase substrates is not as important for PPB as it is for algae. However, in chapter 2, the possibility of a predominant photoautotrophic uptake mechanism was presented in which electron donors were inorganic, such as sulfur compounds or carbon monoxide. More insight into the growth of PPB on inorganic gas streams would be an interesting study. A wide array of high valued products could be obtained by cleaning gaseous waste streams using PPB, however the solid/gas interactions need to be better defined in a CFD model. In chapter 3, two-phase (liquid and gas) systems were used for one of the cases, however this only served as a source of momentum transfer so that mixing within the reactor was sufficient for transport of the biomass to the irradiated zones. As we consider photoautotrophic growth with H\textsubscript{2}S, or CO as electron donors, mass transfer from gas to the liquid or solid phases becomes important. In addition to substrate delivery, mass transfer models can help in developing a more accurate description of the bubble population for momentum transfer \cite{Krishna2003}.

\subsection{Addition of extra functionality for the photo-biological radiation models}
The radiation models were designed for photon transport through a single participating medium. The models account for phase scattering, photon absorption, and photon scattering for any number of scalar quantities within the simulation domain. Multiple of wavelength bands can be defined when running the models, however the bands are not explicitly initialised; they rely on the definition of absorption and scattering coefficients for the specific wavelength bands in question. Being able to run the models by specifying a specific wavelength band, along with its intensity distribution would be simpler for an end user, however this would require a baseline definition for specific absorption and scattering coefficients for common media such as air or water which would be read at run-time. 
\skippingparagraph
The radiation models can also be upgraded to account for the effects of scattering due to the gas phase without tracking for refraction or reflection over each individual bubble, which would lead to unnecessarily high computational costs. A potential workaround for solving the radiative transfer equation (RTE) on a dynamic bubble distribution would be to break the solution process into a number of steps:
\begin{enumerate}
    \item Solve the RTE on a single bubble, and account for reflection and refraction.
    \item Repeat this step for N different sizes of bubbles.
    \item Develop a probabilistic scattering function based on bubble size.
    \item Include scope for the scattering function to be included as a sub-model as is the case for the phase scattering function. 
\end{enumerate}
This solution approach would allow us to describe the behaviour of the radiative field when dynamic bubbles are present, without having to resolve the RTE at each time step of the simulation.
\skippingparagraph
Using CFD to simulate photon transport has been important to gauge performance for UV disinfection simulations \cite{Crapulli2010}. It has been shown that the effects of differing refractive indices can have a significant effect on the outcome of simulations \cite{Ho2009}. Along with bubble dynamics, this is another reason why the model is currently being upgraded to include radiation transport through media with different refractive indices.


\subsection{Description of a suspended phototrophic solid phase}
The CFD model presented in chapter \ref{chap:chap3} essentially described the behaviour of a liquid phase containing particulate matter as passive scalars. Those passive scalars were advected within a photobioreactor into zones of low and high irradiance. The gas phase was used as a momentum source, and its specific limitations have been discussed above. The treatment of the solid phase as a separated dispersed phase in the photobioreactor could have implications its transport in irradiated zones. With a separate dispersed phase, the domain would adopt the physical properties of the particulate species (density, viscosity, heat conductivity, particle size) proportional to their volume fractions. A study assessing solid advection within either a Lagrangian frame of reference, or as a separate dispersed Eulerian phase could give more insight into the real behaviour of phototrophic biomass within a photobioreactor. Such a study has been performed previously \cite{Gao2016} on algal photobioreactors, however a study which can generalise the advection of phototrophic solid advection, including settling, is required. This is to respond to some of the concerns around the costs associated with biomass harvesting and mixing energy requirements. 

\subsection{Incorporation of biofilm behaviour in response to the tangential pressure of a flow field}


\subsection{A study into data-driven design of photobioreactors}
For photobioreactors to graduate from lab and pilot-scale installations to full scale installations, optimisation routines must be performed. Data driven optimisation through machine learning algorithms can be employed by training on operational data, learning from how differences in the operation leads to an array of outputs, and building a corresponding black box model. The resulting model is calibrated and validated on unique operational data \cite{Pedregosa2011}. There is a range of approaches to data driven design, including Bayesian network learning \cite{Hu2018}, convoluted neural networks \cite{RioChanona2019}, or deep neural networks \cite{Deepa2018}. Many software companies have released the source code of their statistical learning software libraries so that users can develop models at a high level of abstraction, while achieving near bare metal performance.
\skippingparagraph
A limitation of applying statistical learning methods for photobioreactor design is that large volumes of data are required before models can make any meaningful sense. With the lack of full scale photobioreactor installations, the modelling framework developed in this thesis could provide full scale installation training and testing data sets, although more laboratory work is required for model calibration and validation. There has been a recent attempt at training a convoluted neural network model on pilot-scale photobioreactor data generated from CFD simulations \cite{RioChanona2019}. This study concluded that for different outcomes (maximised biomass growth or maximised biofuel production), different operating conditions were required. In a broader context, the findings concluded that the coupling of hydrodynamics, radiation, and biokinetics was highly important to the operation of the pilot-scaled photobioreactor, as confirmed in the statistical model. 


\subsection{Numerical improvements to the models}
There are a number of improvements which can be made to the solver for general usability, and for improvements in computational efficiency. This model is based on 10 biokinetic scalar equations. The encoding of these equations is cumbersome, especially in a CFD context where one has to define both time and space varying terms. In more chemically complex systems, such as advanced oxidation processes, there could be hundreds of state variables in the system, and the encoding of these terms would almost certainly produce software bugs through manual errors. By designing the code so that the user can upload a Petersen matrix and the scalar equations are subsequently generated, many encoding errors could be avoided. Work has previously been done for CFD anaerobic digestion models where balance equations are defined at run time \cite{Gaden2013}, however this work could be extended to compile with updated versions of OpenFOAM and to work with uploaded Petersen matrices.
\skippingparagraph
The performance of the radiation solve could be improved for efficiency. The fvDOM is memory intensive, storing all intensity fields. A dynamic allocation/reallocation could be used depending on the physical memory of the computational system. If a system has low memory capacity, fields could be written to disk when not in use. A balance would have to be found between file input/output operations and memory management. At the time of writing, OpenFOAM has high overhead associated with read/write operations, however improvements have been made to I/O handling for parallel simulations such that a single file is written per field per timestep, rather than N I/O operations for N processors \cite{openfoam_foundation_ltd_openfoam_2017}. 


\section{Concluding statement}

\skippingparagraph



